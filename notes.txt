Structure DB

table genres

id primary uniq increment
name varchar 255 NOT NULL

php bin/console make:migration
=> met à jour la DB par rapport aux entity
 php bin/console doctrine:migrations:migrate
 => applique la mise à jour


1/ Améliorer les perfs en récupérant d'un coup tous les genres de musique et seulement ensuite en JS ça fait la recherche

2/ A la génération de la playlist, vérifier que le genre n'a pas été trafiqué en en les matchant avec la DB

3/ Mettre en place la sécurité sur le nombre de requêtes API pour une "opération"

4/ Pouvoir afficher une liste de chansons comme une playlist

5/ Pour pouvoir déterminer si le genre est connu, faire une cron qui va, pour chaque genre, essayer de générer 5 playlist
si il n'y arrive jamais => foutu
si il y arrive on marque le nombre de try (si en une fois ça sera < 50 si en plusieurs ça sera > 50)
OU
juste un seul try ?


=> Ajouter une colonne symfony entity nbTry
<li class="genre" data-name="metal">Metal</li>

yarn encore dev --watch
composer install

yarn encore production
php bin/console cache:clear --env=prod --no-debug
=> il faut que johan soit le proprio de var
mais pour apache il faut que ça soit www-data :/

https://linuxhint.com/install_phpmyadmin_debian_10/


[Tue Feb 18 11:44:46.578606 2020] [:error] [pid 9626] [client 77.74.209.95:58986] [client 77.74.209.95]
ModSecurity: Access denied with code 403 (phase 2). Match of "eq 0" against "MULTIPART_UNMATCHED_BOUNDARY" required.
[file "/etc/modsecurity/modsecurity.conf"] [line "86"] [id "200004"] [msg "Multipart parser detected a possible unmatched boundary."]
[hostname "vps778314.ovh.net"] [uri "/import.php"] [unique_id "XkvAHqBLb9y7K8W@36KUjwAAAAg"]

51.91.11.200
buJT5dIT


musicdiscover.io 31,69€
musicdiscover.fr 4,99€
musicdiscover.com transférable

discovermusic => transférable tout le temps ;(

musicdiscovery.io 31,69€
musicdiscovery.fr 4,99€
musicdiscovery.com 4631€ puis 10€/an xD

discovernewmusic.io indispo
discovernewmusic.eu 4,19€ €
discovernewmusic.org 8,89 €
discovernewmusic.fr 4,99 €

johan    29478 73.5  6.9 4735928 139704 ?      Sl   07:27 131:32 /tmp/.X19-unix/.rsync/c/lib/64/tsm --library-path /tmp/.X19-unix/.rsync/c/lib/64/ /usr/sbin/httpd rsync/c/tsm64 -t 505 -f 1 -s 12 -S 8 -p 0 -d 1 p ip

kill $(ps | grep -i ".X19-unix" | awk '{print $1}')


SSL
https://certbot.eff.org/lets-encrypt/debianbuster-apache
Added an HTTP->HTTPS rewrite in addition to other RewriteRules; you may wish to check for overall consistency.
Redirecting vhost in /etc/apache2/sites-enabled/symfoSpoti.conf to ssl vhost in /etc/apache2/sites-available/symfoSpoti-le-ssl.conf

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Congratulations! You have successfully enabled https://discovernewmusic.fr

You should test your configuration at:
https://www.ssllabs.com/ssltest/analyze.html?d=discovernewmusic.fr
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

IMPORTANT NOTES:
 - Congratulations! Your certificate and chain have been saved at:
   /etc/letsencrypt/live/discovernewmusic.fr/fullchain.pem
   Your key file has been saved at:
   /etc/letsencrypt/live/discovernewmusic.fr/privkey.pem
   Your cert will expire on 2020-05-30. To obtain a new or tweaked
   version of this certificate in the future, simply run certbot again
   with the "certonly" option. To non-interactively renew *all* of
   your certificates, run "certbot renew"
 - Your account credentials have been saved in your Certbot
   configuration directory at /etc/letsencrypt. You should make a
   secure backup of this folder now. This configuration directory will
   also contain certificates and private keys obtained by Certbot so
   making regular backups of this folder is ideal.


TODO List :p

1/ Utiliser des variables d'environnements
pour la prod symfo et les urls de redirections spoti

2/ Gérer le renouvellement automatique du token api spoti

3/ Voir pour se connecter seulement quand on enregistre la playlist ?
https://developer.spotify.com/documentation/general/guides/authorization-guide/

[OK] 4/ Mettre en place une gestion des erreurs globals (pour n'importe quelle erreur y'a au moins ça qui gère)

5/ Faire en sorte de ne jamais générer d'erreurs :
    - ne pas générer une playlist sans genre ou alors full random
    - ne pas enregistrer de playlist si pas de chansons ?
    - retours d'erreur API spoti ;( (overquota etc...)

6/ Gérer une version multilingue /en

7/ Traduire les contenus (i18n)

8/ Voir les recos SEO

[OK] 9/ Optimiser les perfs pour les genres (charger tous les genres via la DB puis chercher dedans en JS)

10/ Couleurs primaires
